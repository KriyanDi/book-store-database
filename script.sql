-- creating tables --

CREATE TABLE BOOK
(
    SKU        INTEGER  NOT NULL UNIQUE,
    BARCODE    CHAR(12) NOT NULL UNIQUE,
    PRICE      DECIMAL(9, 2),
    STORGQUANT INTEGER,
    CATEGORY   CHAR(10),
    VENDORID   INTEGER,
    GENRE      CHAR(10),
    TITLE      VARCHAR(50),
    AUTHOR     VARCHAR(50),
    LANGUAGE   VARCHAR(50),
    PUBLISHER  VARCHAR(50),
    NUMOFPAGES INTEGER
);

CREATE TABLE NOTEBOOK
(
    SKU         INTEGER  NOT NULL UNIQUE,
    BARCODE     CHAR(12) NOT NULL UNIQUE,
    PRICE       DECIMAL(9, 2),
    STORGQUANT  INTEGER,
    CATEGORY    CHAR(10),
    VENDORID    INTEGER,
    TYPE        VARCHAR(50),
    FORMAT      CHAR(3),
    RECYCLPAPER CHAR(1),
    NUMOFPAGES  INTEGER
);

CREATE TABLE PEN
(
    SKU        INTEGER  NOT NULL UNIQUE,
    BARCODE    CHAR(12) NOT NULL UNIQUE,
    PRICE      DECIMAL(9, 2),
    STORGQUANT INTEGER,
    CATEGORY   CHAR(10),
    VENDORID   INTEGER,
    SIZE       DECIMAL(9, 2),
    COLOUR     CHAR(10)
);

CREATE TABLE PENCIL
(
    SKU        INTEGER  NOT NULL UNIQUE,
    BARCODE    CHAR(12) NOT NULL UNIQUE,
    PRICE      DECIMAL(9, 2),
    STORGQUANT INTEGER,
    CATEGORY   CHAR(10),
    VENDORID   INTEGER,
    TYPE       CHAR(4),
    ERASER     CHAR(1),
    COLOUR     CHAR(10)
);

CREATE TABLE ALLSKU
(
    SKU INTEGER NOT NULL UNIQUE
);

CREATE TABLE ORDER
(
    ORDERNO CHAR(6) NOT NULL,
    STATUS  CHAR(15),
    CARDNO  INTEGER
);

CREATE TABLE ADDRESS
(
    ID            INTEGER  NOT NULL,
    COUNTRY       CHAR(20) NOT NULL,
    CITY          CHAR(20) NOT NULL,
    NEIGHBOURHOOD CHAR(20) NOT NULL,
    STREET        CHAR(20) NOT NULL,
    APARTMENTNO   INTEGER,
    POSTALCODE    INTEGER
);

CREATE TABLE PAYMENT
(
    CARDNO      INTEGER  NOT NULL,
    CARDTYPE    CHAR(20),
    CARDHOLDERN CHAR(30),
    CARDHOLDERS CHAR(30) NOT NULL,
    CARDEXPIRED DATE
);

CREATE TABLE MEMBER
(
    EMAIL     CHAR(30) NOT NULL UNIQUE,
    NAME      CHAR(30) NOT NULL,
    SURNAME   CHAR(30) NOT NULL,
    PASSWORD  CHAR(16) NOT NULL,
    IDADDRESS INTEGER
);

CREATE TABLE BASKET
(
    ID         INTEGER NOT NULL,
    TOTALPRICE DECIMAL(9, 2),
    ORDERNO    CHAR(6),
    CARDNO     INTEGER,
    EMAIL      CHARACTER(30),
    SKU        INTEGER,
    QUANTITY   INTEGER
);

CREATE TABLE VENDOR
(
    ID          INTEGER  NOT NULL,
    EMAIL       CHAR(40),
    FIRSTNAME   CHAR(12),
    LASTNAME    CHAR(12),
    PHONE       CHAR(10),
    COMPANYNAME CHAR(15) NOT NULL,
    URL         CHAR(32)
);

CREATE TABLE VENDORADDRESS
(
    ID        INTEGER NOT NULL,
    IDVENDOR  INTEGER,
    IDADDRESS INTEGER
);

-- setting keys and checks --

ALTER TABLE BOOK
    ADD CONSTRAINT PK_BOOK PRIMARY KEY (SKU);

ALTER TABLE BOOK
    ADD CONSTRAINT FK_BOOK_VENDORID FOREIGN KEY (VENDORID)
        REFERENCES VENDOR (ID);

ALTER TABLE BOOK
    ADD CONSTRAINT CH_BARCODE CHECK (LENGTH(BARCODE) = 12);

ALTER TABLE BOOK
    ADD CONSTRAINT CH_CATEGORY CHECK (CATEGORY IN ('book'));

ALTER TABLE NOTEBOOK
    ADD CONSTRAINT PK_NOTEBOOK PRIMARY KEY (SKU);

ALTER TABLE NOTEBOOK
    ADD CONSTRAINT FK_NOTEBOOK_VENDOR_ID FOREIGN KEY (VENDORID)
        REFERENCES VENDOR (ID);

ALTER TABLE NOTEBOOK
    ADD CONSTRAINT CH_BARCODE CHECK (LENGTH(BARCODE) = 12);

ALTER TABLE NOTEBOOK
    ADD CONSTRAINT CH_CATEGORY CHECK (CATEGORY IN ('notebook'));

ALTER TABLE NOTEBOOK
    ADD CONSTRAINT CH_FORMAT CHECK (FORMAT IN ('A2', 'A3', 'A4', 'A5', 'A6'));

ALTER TABLE NOTEBOOK
    ADD CONSTRAINT CH_RECYCLPAPER CHECK (RECYCLPAPER IN ('y', 'n'));

ALTER TABLE PEN
    ADD CONSTRAINT PK_PEN PRIMARY KEY (SKU);

ALTER TABLE PEN
    ADD CONSTRAINT FK_PEN_VENDOR_ID FOREIGN KEY (VENDORID)
        REFERENCES VENDOR (ID);

ALTER TABLE PEN
    ADD CONSTRAINT CH_BARCODE CHECK (LENGTH(BARCODE) = 12);

ALTER TABLE PEN
    ADD CONSTRAINT CH_CATEGORY CHECK (CATEGORY IN ('pen'));

ALTER TABLE PENCIL
    ADD CONSTRAINT PK_PENCIL PRIMARY KEY (SKU); 

ALTER TABLE PENCIL
    ADD CONSTRAINT FK_PENCIL_VENDOR_ID FOREIGN KEY (VENDORID)
        REFERENCES VENDOR (ID);

ALTER TABLE PENCIL
    ADD CONSTRAINT CH_BARCODE CHECK (LENGTH(BARCODE) = 12);

ALTER TABLE PENCIL
    ADD CONSTRAINT CH_CATEGORY CHECK (CATEGORY IN ('pencil'));

ALTER TABLE PENCIL
    ADD CONSTRAINT CH_ERASER CHECK (ERASER IN ('y', 'n'));

ALTER TABLE ORDER
    ADD CONSTRAINT PK_ORDER PRIMARY KEY (ORDERNO);

ALTER TABLE ORDER
    ADD CONSTRAINT FK_ORDER_PAYMENT FOREIGN KEY (CARDNO)
        REFERENCES PAYMENT (CARDNO);

ALTER TABLE MEMBER
    ADD CONSTRAINT PK_MEMBER PRIMARY KEY (EMAIL);

ALTER TABLE MEMBER
    ADD CONSTRAINT FK_MEMBER_ADDRESS FOREIGN KEY (IDADDRESS)
        REFERENCES ADDRESS (ID);

ALTER TABLE MEMBER
    ADD CONSTRAINT CH_EMAIL CHECK (EMAIL LIKE '%_@%_.%_');

ALTER TABLE PAYMENT
    ADD CONSTRAINT PK_PAYMENT PRIMARY KEY (CARDNO);

ALTER TABLE ADDRESS
    ADD CONSTRAINT PK_ADDRESS PRIMARY KEY (ID);

ALTER TABLE ADDRESS
    ADD CONSTRAINT CH_ID CHECK (ID > 0);

ALTER TABLE ADDRESS
    ADD CONSTRAINT CH_APARTAMENTNO CHECK (APARTMENTNO > 0);

ALTER TABLE ADDRESS
    ADD CONSTRAINT CH_POSTALCODE CHECK (POSTALCODE > 0);

       